# 07-暗中观察 🕵️‍♂️

## 👀 盯着它！

有时候，我们不仅想显示数据，还想在数据变化的时候**干点坏事**（副作用）。
比如：
- 用户输入了搜索词，我就去服务器请求数据。
- 用户改变了主题色，我就把设置保存到本地存储。
- 只有当用户积分大于 100 时，才弹窗恭喜。

这时候，我们需要 `watch` (监听器)。

## 1. `watch` 的用法

`watch` 需要两个参数：
1. 你要侦听的数据源（谁？）。
2. 回调函数（变了之后干嘛？）。

### 🌰 举个栗子

```html
<script setup>
  import { ref, watch } from 'vue';

  const question = ref('');
  const answer = ref('你在问啥？');

  // 监听 question 变量
  // newQ 是新值，oldQ 是旧值
  watch(question, (newQ, oldQ) => {
    if (newQ.includes('?')) {
      answer.value = '思考中...';
      // 模拟去服务器请求答案
      setTimeout(() => {
        answer.value = '答案是：42';
      }, 1000);
    }
  });
</script>

<template>
  <p>问个问题（记得带问号）：</p>
  <input v-model="question" />
  <p>{{ answer }}</p>
</template>
```

> **补充知识**：`v-model` 是什么？
> 上面的例子里用了 `v-model="question"`。这是 Vue 的双向绑定语法糖。
> 意思就是：input 里的字变了，`question` 变量自动变；`question` 变量变了，input 里的字也自动变。
> 在表单元素（input, checkbox）上非常常用！

## 2. `watch` vs `computed`

- **computed**: 我要**产出**一个新数据（不干坏事，只计算）。必须有 `return`。
- **watch**: 我要**执行**一个动作（去请求、去打印 log、去存数据）。不需要 `return`。

## 🎒 课后小结

- 想在数据变化时做点“副作用”（Side Effects）？用 `watch`。
- 记得引入 `watch`。

好了，响应式三巨头 (`ref`, `computed`, `watch`) 你都学会了！
接下来的课程，我们要开始像搭积木一样构建大型应用了！🧱
