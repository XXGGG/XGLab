# 02- 什么时候你才真正需要它？（拒绝焦虑）

## 🙅‍♂️ 千万别觉得自己“弱”！

首先，**请立刻停止自我怀疑！** 🛑

如果你的项目很简单，或者只是展示型的页面，**不写单元测试是完全正确的选择**。如果你非要给一个“点击按钮弹个窗”的功能写测试，那才叫“过度工程化”（Over-engineering），是会被老板（或者未来的自己）骂浪费时间的。

## 🤔 既然 1+2=3 没必要测，那测什么？

确实，`1+2=3` 这种测试纯属**“脱裤子放屁”**。

单元测试真正发光发热的地方，在于**“逻辑复杂且容易出错”**的纯计算场景。

### 🛒 场景：双十一购物车计算器

想象一下，你正在做一个电商小项目，有一个计算最终价格的函数。规则如下：

1.  满 100 减 10 块。
2.  满 200 减 30 块。
3.  如果是 VIP 用户，在满减之后，还能再打 9 折。

这个逻辑，如果让你**“人肉测试”**，你得怎么做？
1.  打开网页。
2.  加商品进购物车，凑到 100 块。
3.  看价格对不对。
4.  再加商品，凑到 200 块。
5.  看价格对不对。
6.  登录一个 VIP 账号，再重复一遍……
7.  **如果这时候老板改需求了：满 200 改成减 40 了？** 😱 你得全部重来一遍！

### ✨ Vitest 救场时刻

这时候，写个测试脚本就比人肉测快多了：

```javascript
// price.js (你的业务逻辑)
export function calculateTotal(price, isVip) {
  let finalPrice = price;
  
  // 满减逻辑
  if (price >= 200) {
    finalPrice -= 30;
  } else if (price >= 100) {
    finalPrice -= 10;
  }
  
  // VIP 逻辑
  if (isVip) {
    finalPrice *= 0.9;
  }
  
  return finalPrice;
}
```

```javascript
// price.test.js (Vitest 帮你测)
import { expect, test } from 'vitest'
import { calculateTotal } from './price'

test('普通用户：满100减10', () => {
  expect(calculateTotal(100, false)).toBe(90)
})

test('普通用户：满200减30', () => {
  expect(calculateTotal(200, false)).toBe(170)
})

test('VIP用户：满200减30后再打9折', () => {
  // (200 - 30) * 0.9 = 153
  expect(calculateTotal(200, true)).toBe(153)
})
```

**有了这个文件，下次老板改需求，你只需要：**
1.  改代码。
2.  改测试里的数字。
3.  按一下保存，Vitest **0.1秒** 告诉你结果对不对。

## 💡 结论

只有当你遇到下面这两种情况时，再考虑请 Vitest 出山：

1.  **逻辑复杂**：像上面的购物车、复杂的表单验证（密码必须包含大小写字母数字）、复杂的日期计算。
2.  **不仅自己用**：你写的函数要给别人用，或者是一个开源库。你想保证别人用的时候不出错。

**除此之外？** 
放心大胆地 `console.log` 吧！那是我们开发者的浪漫！🌹
