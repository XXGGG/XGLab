# 09-å®‰å…¨ç¬¬ä¸€.md

ğŸ›¡ï¸ æ¬¢è¿æ¥åˆ°æœ€åä¸€è¯¾ï¼

ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æŠ¥é”™ï¼š`Uncaught TypeError: Cannot read properties of undefined (reading 'xxx')`ï¼Ÿ
è¿™å°±åƒä½ è¯•å›¾å»æ‹¿â€œç©ºæ°”â€çš„å£è¢‹é‡Œçš„ç³–æœï¼Œç¨‹åºç›´æ¥ç»™ä½ å´©äº†ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES6ï¼ˆå‡†ç¡®è¯´æ˜¯ ES2020ï¼‰ç»™äº†æˆ‘ä»¬ä¸¤ä¸ªæ•‘å‘½ç¨»è‰ï¼š**å¯é€‰é“¾ (Optional Chaining)** å’Œ **ç©ºå€¼åˆå¹¶ (Nullish Coalescing)**ã€‚

## ğŸ£ åŸºç¡€ç”¨æ³•

### 1. å¯é€‰é“¾ `?.`ï¼šæœ‰ç‚¹å°±æ‹¿ï¼Œæ²¡ç‚¹å°±æ’¤

å‡è®¾æ•°æ®ç»“æ„æ˜¯è¿™æ ·çš„ï¼š
```javascript
const user = {
  name: "Trae",
  address: {
    // city: "Beijing" // å‡è®¾æœ‰æ—¶å€™æ²¡è¿™ä¸ªå­—æ®µ
  }
};
```

ä»¥å‰ä¸ºäº†å®‰å…¨å– `city`ï¼š
```javascript
const city = user && user.address && user.address.city; // å†™æ³•æå…¶ä¸‘é™‹
```

ç°åœ¨ï¼š
```javascript
const city = user?.address?.city; 
// å¦‚æœ user æ˜¯ null/undefinedï¼Œæˆ–è€… address æ˜¯ null/undefinedï¼Œ
// å®ƒä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯ç›´æ¥è¿”å› undefinedã€‚
console.log(city); // undefined (ç¨‹åºç»§ç»­è¿è¡Œï¼Œä¸å´©ï¼)
```

### 2. ç©ºå€¼åˆå¹¶ `??`ï¼šå¤‡èƒä¸“ç”¨

å¦‚æœå–åˆ°äº† `undefined` æˆ– `null`ï¼Œæˆ‘æƒ³ç»™å®ƒä¸€ä¸ªé»˜è®¤å€¼ã€‚

```javascript
const city = user?.address?.city ?? "Unknown City";
console.log(city); // "Unknown City"
```

**åŒºåˆ«äº `||`**ï¼š
`||` ä¼šæŠŠ `0` æˆ– `""` (ç©ºå­—ç¬¦ä¸²) ä¹Ÿå½“æˆå‡å€¼ã€‚
`??` **åªè®¤** `null` å’Œ `undefined`ã€‚

```javascript
const score = 0;

const a = score || 60; // 60 (å“å‘€ï¼Œ0åˆ†è¢«å½“æˆæ²¡è€ƒäº†)
const b = score ?? 60; // 0  (0åˆ†ä¹Ÿæ˜¯åˆ†ï¼)
```

## ğŸ­ åœºæ™¯å®æˆ˜

### Vue (Nuxt) ä¸­çš„ç”¨æ³•

åœ¨æ¨¡æ¿ä¸­æ¸²æŸ“æ·±å±‚æ•°æ®æ—¶è¶…çº§å¥½ç”¨ï¼

```html
<template>
  <div>
    <!-- å¦‚æœ data è¿˜æ²¡åŠ è½½å›æ¥ï¼Œç›´æ¥æ˜¾ç¤º undefinedï¼Œä¸ä¼šæŠ¥é”™ç™½å± -->
    <h1>{{ data?.post?.title }}</h1>
    
    <!-- æ˜¾ç¤ºç”¨æˆ·æ˜µç§°ï¼Œå¦‚æœæ²¡æœ‰å°±æ˜¾ç¤º 'åŒ¿åç”¨æˆ·' -->
    <p>ä½œè€…ï¼š{{ data?.user?.nickname ?? 'åŒ¿åç”¨æˆ·' }}</p>
  </div>
</template>
```

### React (Next) ä¸­çš„ç”¨æ³•

åŒç†ï¼Œåœ¨ JSX ä¸­é˜²æ­¢æ¸²æŸ“å´©æºƒã€‚

```javascript
const UserProfile = ({ user }) => {
  // user å¯èƒ½ä¸€å¼€å§‹æ˜¯ null
  return (
    <div>
      {/* ä»¥å‰è¿™é‡Œå¾ˆå®¹æ˜“æŠ¥é”™ */}
      <h2>{user?.name}</h2>
      
      {/* è°ƒç”¨å‡½æ•°ä¹Ÿå¯ä»¥ç”¨ ?. */}
      <button onClick={() => user?.onLogin?.()}>
        ç™»å½•
      </button>
    </div>
  );
};
```

## ğŸ§  æ€»ç»“

- åªè¦è®¿é—®æ·±å±‚å¯¹è±¡å±æ€§ï¼Œä¸ç¡®å®šä¸­é—´æ˜¯ä¸æ˜¯ç©ºçš„ï¼Œå°±åŠ ä¸Š `?.`ã€‚
- æƒ³è®¾ç½®é»˜è®¤å€¼ï¼Œä¼˜å…ˆç”¨ `??`ï¼Œæ¯” `||` æ›´ç²¾å‡†ã€‚
- è¿™ä¸¤ä¸ªç¬¦å·èƒ½æ¶ˆç­ 90% çš„ `Cannot read properties of undefined` é”™è¯¯ã€‚

## âœï¸ è¯¾åä½œä¸š

1.  ä»£ç æ‰¾èŒ¬ï¼š
    ```javascript
    const config = { timeout: 0 };
    const time = config.timeout || 1000; 
    // time æ˜¯å¤šå°‘ï¼Ÿå¦‚æœä½ æƒ³è®©å®ƒæ˜¯ 0ï¼Œåº”è¯¥æ€ä¹ˆæ”¹ï¼Ÿ
    ```
2.  ç»™ä¸€ä¸ªå¯èƒ½ä¸ºç©ºçš„æ•°ç»„ `list`ï¼Œå¦‚ä½•å®‰å…¨åœ°è·å–å®ƒçš„é•¿åº¦ï¼Ÿï¼ˆæç¤ºï¼š`list` å¯èƒ½æ˜¯ `undefined`ï¼‰ã€‚

---
**ğŸ‰ ç»“è¯­**

æ­å–œä½ ï¼ä½ å·²ç»å­¦å®Œäº†ã€ŠES6 å®ç”¨ç”Ÿå­˜æŒ‡å—ã€‹çš„æ‰€æœ‰è¯¾ç¨‹ï¼
ç°åœ¨çš„ä½ ï¼Œå·²ç»æŒæ¡äº† Nuxt å’Œ Next å¼€å‘ä¸­æœ€æ ¸å¿ƒçš„ JS æŠ€èƒ½ã€‚
å»å†™ä»£ç å§ï¼Œå»åˆ›é€ å§ï¼å¦‚æœå¿˜äº†ï¼Œéšæ—¶å›æ¥ç¿»ç¿»è¿™æœ¬ç§˜ç±ã€‚

ä¿æŒå¥½å¥‡ï¼Œä¿æŒå¹½é»˜ï¼Œæˆ‘ä»¬æ±Ÿæ¹–å†è§ï¼ğŸ‘‹


## ğŸŸ¢ XXGä½œä¸šï¼š

```javascript
const config = { timeout: 0 };
const time = config?.timeout ?? 1000; 
// time æ˜¯å¤šå°‘ï¼Ÿå¦‚æœä½ æƒ³è®©å®ƒæ˜¯ 0ï¼Œåº”è¯¥æ€ä¹ˆæ”¹ï¼Ÿ

const l = list?.length || 0
```